functions for data set processing